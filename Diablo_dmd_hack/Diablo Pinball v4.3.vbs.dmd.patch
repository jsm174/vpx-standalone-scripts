--- "./Diablo Pinball v4.3.vbs.original"	2024-02-07 19:20:45.943451093 +0100
+++ "./Diablo Pinball v4.3.vbs"	2023-12-26 00:30:26.572508417 +0100
@@ -64,6 +64,29 @@
 Option Explicit
 Randomize
 
+'///////////////////////-----Hack to display FlexDMD on Vpx-standalone-----///////////////////////
+Sub ImplicitDMD_Init
+   Me.x = 30
+   Me.y = 30
+   Me.width = 128 * 2
+   Me.height = 32 * 2
+   Me.fontColor = RGB(255, 255, 255)
+   Me.visible = true
+   Me.intensityScale = 1.5
+   Me.timerenabled = true
+End Sub
+
+Sub ImplicitDMD_Timer
+   Dim DMDp: DMDp = UltraDMD.DMDColoredPixels
+   If Not IsEmpty(DMDp) Then
+      DMDWidth = UltraDMD.Width
+      DMDHeight = UltraDMD.Height
+      DMDColoredPixels = DMDp
+   End If
+End Sub
+'///////////////////////-----End of Hack to display FlexDMD on Vpx-standalone-----///////////////////////
+
+
 '♥♡♥♡♥♡♥♡♥♡♥♡♥♡♥ PLayer choices ♥♡♥♡♥♡♥♡♥♡♥♡♥♡♥
 
 Const MalthaelMode = 1 'Options:  0 = easy,   1 = hard,   2 = insane
@@ -1209,36 +1232,36 @@
         'Lane Bonus
         AwardPoints = LaneBonus * 1000
         TotalBonus = AwardPoints
-        DMD "bonus-background.wmv", "LANE BONUS", AwardPoints, 700
+        DMD "bonus-background.gif", "LANE BONUS", AwardPoints, 700
         vpmtimer.addtimer 1300, "PlaySound ""bonus"", 0, 1, 0, 0, 0, 0, 0 '"
 
         'Number of Target banks completed
         AwardPoints = TargetBonus * 100000
         TotalBonus = TotalBonus + AwardPoints
-        DMD "bonus-background.wmv", "TARGET BONUS", AwardPoints, 700
+        DMD "bonus-background.gif", "TARGET BONUS", AwardPoints, 700
         vpmtimer.addtimer 2200, "PlaySound ""bonus"", 0, 1, 0, 0, 1000, 0, 0 '"
 
         'Number of Ramps completed
         AwardPoints = RampBonus * 10000
         TotalBonus = TotalBonus + AwardPoints
-        DMD "bonus-background.wmv", "RAMP BONUS", AwardPoints, 700
+        DMD "bonus-background.gif", "RAMP BONUS", AwardPoints, 700
         vpmtimer.addtimer 2900, "PlaySound ""bonus"", 0, 1, 0, 0, 2000, 0, 0 '"
 
         'Number of Orbits registered
         AwardPoints = OrbitHits * 32260
         TotalBonus = TotalBonus + AwardPoints
-        DMD "bonus-background.wmv", "ORBIT BONUS", AwardPoints, 700
+        DMD "bonus-background.gif", "ORBIT BONUS", AwardPoints, 700
         vpmtimer.addtimer 3600, "PlaySound ""bonus"", 0, 1, 0, 0, 3000, 0, 0 '"
 
         'Number of monsters defeated
         AwardPoints = Monsters(CurrentPlayer) * 25130
-        DMD "bonus-background.wmv", "MONSTERS KILLED", monsters(CurrentPlayer), 700
+        DMD "bonus-background.gif", "MONSTERS KILLED", monsters(CurrentPlayer), 700
         vpmtimer.addtimer 4400, "PlaySound ""bonus"", 0, 1, 0, 0, 4000, 0, 0 '"
 
         'Player Level
         AwardPoints = Level(CurrentPlayer) * 50000
         TotalBonus = TotalBonus + AwardPoints
-        DMD "bonus-background.wmv", "LEVEL BONUS", Level(CurrentPlayer), 700
+        DMD "bonus-background.gif", "LEVEL BONUS", Level(CurrentPlayer), 700
         vpmtimer.addtimer 5000, "PlaySound ""bonus"", 0, 1, 0, 0, 5000, 0, 0 '"
 
         ' calculate the totalbonus
@@ -1259,7 +1282,7 @@
         bBonusHeld = False
 
         ' Add the bonus to the score
-        DMD "bonus-background.wmv", "TOTAL BONUS X " &BonusMultiplier(CurrentPlayer), TotalBonus, 2200
+        DMD "bonus-background.gif", "TOTAL BONUS X " &BonusMultiplier(CurrentPlayer), TotalBonus, 2200
         vpmtimer.addtimer 6200, "PlaySound ""goblin"" '"
         AddScore TotalBonus
 
@@ -1294,7 +1317,7 @@
         End If
 
         ' You may wish to do a bit of a song AND dance at this point
-        DMD "extra-ball.wmv", "", "", 5000
+        DMD "extra-ball.gif", "", "", 5000
 
         ' In this table an extra ball will have the skillshot and ball saver, so we reset the playfield for the new ball
         ResetForNewPlayerBall()
@@ -1395,7 +1418,7 @@
     ' terminate all Mode - eject locked balls
     ' most of the Mode/timers terminate at the end of the ball
     ' show game over on the DMD
-    DMD "game-over.wmv", "", "", 11000
+    DMD "game-over.gif", "", "", 11000
 
     ' set any lights for the attract mode
     GiOff
@@ -1449,7 +1472,7 @@
             ' we kick the ball with the autoplunger
             bAutoPlunger = True
             ' you may wish to put something on a display or play a sound at this point
-            DMD "ball-save.wmv", "", "", 5000
+            DMD "ball-save.gif", "", "", 5000
         Else
             ' cancel any multiball if on last ball (ie. lost all other balls)
             If(BallsOnPlayfield = 1)Then
@@ -1481,10 +1504,10 @@
                 DMDFlush
                 Select Case Mode(0)
                     Case 0, 1, 3, 5, 7
-                        DMD "ball-lost-2.wmv", "", "", 5000
+                        DMD "ball-lost-2.gif", "", "", 5000
                         vpmtimer.addtimer 4500, "EndOfBall '"
                     Case 2, 4, 6, 8, 10
-                        DMD "ball-lost-1.wmv", "", "", 10000
+                        DMD "ball-lost-1.gif", "", "", 10000
                         vpmtimer.addtimer 9500, "EndOfBall '"
                 End Select
                 StopEndOfBallMode
@@ -1547,7 +1570,7 @@
 ' swPlungerRest timer to show the "launch ball" if the player has not shot the ball during 6 seconds
 
 Sub swPlungerRest_Timer
-    DMD "start.wmv", "", "", 17000
+    DMD "start.gif", "", "", 17000
     swPlungerRest.TimerEnabled = 0
 End Sub
 
@@ -1678,7 +1701,7 @@
 Sub AwardExtraBall()
     If NOT bExtraBallWonThisBall Then
         DMDBlink "black.jpg", " ", "EXTRA BALL WON", 100, 10
-        'DMD "extra-ball.wmv", "", "", 5000
+        'DMD "extra-ball.gif", "", "", 5000
         ExtraBallsAwards(CurrentPlayer) = ExtraBallsAwards(CurrentPlayer) + 1
         DOF 121, DOFPulse
         DOF 112, DOFPulse
@@ -1743,22 +1766,22 @@
     DMDFlush
     Select case SkillShotValue(CurrentPlayer)
         case 1000000
-            DMD "skillshot1.wmv", " ", " ", 5000
+            DMD "skillshot1.gif", " ", " ", 5000
             AddScore SkillshotValue(CurrentPLayer)
         case 2000000
-            DMD "skillshot2.wmv", " ", " ", 5000
+            DMD "skillshot2.gif", " ", " ", 5000
             AddScore SkillshotValue(CurrentPLayer)
         case 3000000
-            DMD "skillshot3.wmv", " ", " ", 5000
+            DMD "skillshot3.gif", " ", " ", 5000
             AddScore SkillshotValue(CurrentPLayer)
         case 4000000
-            DMD "skillshot4.wmv", " ", " ", 5000
+            DMD "skillshot4.gif", " ", " ", 5000
             AddScore SkillshotValue(CurrentPLayer)
         case 5000000
-            DMD "skillshot5.wmv", " ", " ", 5000
+            DMD "skillshot5.gif", " ", " ", 5000
             AddScore SkillshotValue(CurrentPLayer)
         case ELSE
-            DMD "skillshot.wmv", " ", " ", 5000
+            DMD "skillshot.gif", " ", " ", 5000
             AddScore SkillshotValue(CurrentPLayer)
     End Select
     ' increment the skillshot value with 1 million
@@ -2344,24 +2367,24 @@
 
 ' Load & Save UltraDMD colors
 Sub SetDMDColors
-    Dim WshShell:Set WshShell = CreateObject("WScript.Shell")
-    ' Read the current Values
-    On Error Resume Next
-    DMDOldColor = WshShell.RegRead("HKCU\Software\UltraDMD\color")
-    DMDOldFullColor = WshShell.RegRead("HKCU\Software\UltraDMD\fullcolor")
-    If DMDOldFullColor = "" Then DMDOldFullColor = "False"
-    ' Set table Values
-    WshShell.RegWrite "HKCU\Software\UltraDMD\fullcolor", "True", "REG_SZ"
-    WshShell.RegWrite "HKCU\Software\UltraDMD\color", "Tomato", "REG_SZ"
-    WshShell.RegWrite "HKCU\Software\UltraDMD\hideVDMD", "False", "REG_SZ"
-    On Error Goto 0
+    ' Dim WshShell:Set WshShell = CreateObject("WScript.Shell")
+    ' ' Read the current Values
+    ' On Error Resume Next
+    ' DMDOldColor = WshShell.RegRead("HKCU\Software\UltraDMD\color")
+    ' DMDOldFullColor = WshShell.RegRead("HKCU\Software\UltraDMD\fullcolor")
+    ' If DMDOldFullColor = "" Then DMDOldFullColor = "False"
+    ' ' Set table Values
+    ' WshShell.RegWrite "HKCU\Software\UltraDMD\fullcolor", "True", "REG_SZ"
+    ' WshShell.RegWrite "HKCU\Software\UltraDMD\color", "Tomato", "REG_SZ"
+    ' WshShell.RegWrite "HKCU\Software\UltraDMD\hideVDMD", "False", "REG_SZ"
+    ' On Error Goto 0
 End Sub
 
 Sub DMD_Exit
     If UltraDMD.IsRendering Then UltraDMD.CancelRendering
-    Dim WshShell:Set WshShell = CreateObject("WScript.Shell")
-    WshShell.RegWrite "HKCU\Software\UltraDMD\color", DMDOldColor, "REG_SZ"
-    WshShell.RegWrite "HKCU\Software\UltraDMD\fullcolor", DMDOldFullColor, "REG_SZ"
+    ' Dim WshShell:Set WshShell = CreateObject("WScript.Shell")
+    ' WshShell.RegWrite "HKCU\Software\UltraDMD\color", DMDOldColor, "REG_SZ"
+    ' WshShell.RegWrite "HKCU\Software\UltraDMD\fullcolor", DMDOldFullColor, "REG_SZ"
     UltraDMD = Null
 End Sub
 
@@ -2388,14 +2411,14 @@
     'coins or freeplay
     If bFreePlay Then
         DMD "black.jpg", " ", "FREE PLAY", 2000
-        DMD "intro-freeplay.wmv", "", "", 63000
+        DMD "intro-freeplay.gif", "", "", 63000
     Else
         If Credits > 0 Then
             DMD "black.jpg", "CREDITS " &credits, "PRESS START", 2000
         Else
             DMD "black.jpg", "CREDITS " &credits, "INSERT COIN", 2000
         End If
-        DMD "intro-coins.wmv", "", "", 65000
+        DMD "intro-coins.gif", "", "", 65000
     End If
 
     DMD "black.jpg", "HIGHSCORES", "1> " & HighScoreName(0) & " " & FormatNumber(HighScore(0), 0, , , -1), 3000
@@ -2986,7 +3009,7 @@
         LightEffect 3
         FlashEffect 3
         'DMD
-        DMD "levelup.wmv", "", "", 3000
+        DMD "levelup.gif", "", "", 3000
         ' open the gates and enable the orbit shots
         Gate1.Open = true:Gate2.Open = True
         OrbitCloseTimer.Enabled = 1
@@ -3064,7 +3087,7 @@
 
 Sub CheckQUESTLanes() 'use the lane lights
     If l15.State + l16.State + l17.State + l18.State + l19.State = 5 Then
-        DMD "quest-lights.wmv", "", "", 4000
+        DMD "quest-lights.gif", "", "", 4000
         'Increase bonus multiplier
         AddBonusMultiplier 1
         'flash and Light effect
@@ -3220,7 +3243,7 @@
         End If
         Select Case Mode(0)
             Case 1, 3, 5, 7, 9
-                DMD "bash-lights.wmv", "", "", 4000
+                DMD "bash-lights.gif", "", "", 4000
                 MonsterHits = MonsterHits + 5 + Level(CurrentPlayer)
                 CheckActMonsters
                 MonsterHitTimer_Timer
@@ -3411,7 +3434,7 @@
         End If
         Select Case Mode(0)
             Case 1, 3, 5, 7, 9
-                DMD "skill-lights.wmv", "", "", 3000
+                DMD "skill-lights.gif", "", "", 3000
                 MonsterHits = MonsterHits + 7 + Level(CurrentPlayer)
                 CheckActMonsters
                 MonsterHitTimer_Timer
@@ -3597,7 +3620,7 @@
                 Case 1, 3, 5, 7, 9
                     GiEffect 2
                     DOF 125, DOFPulse
-                    DMD "leftloop.wmv", "", "", 2000
+                    DMD "leftloop.gif", "", "", 2000
                     Monsters(CurrentPlayer) = Monsters(CurrentPlayer) + 1 'bonus
                     MonsterHits = MonsterHits + 1 + Level(CurrentPlayer)
                     CheckActMonsters
@@ -3646,7 +3669,7 @@
                 Case 1, 3, 5, 7, 9
                     GiEffect 2
                     DOF 125, DOFPulse
-                    DMD "rightloop.wmv", "", "", 2000
+                    DMD "rightloop.gif", "", "", 2000
                     Monsters(CurrentPlayer) = Monsters(CurrentPlayer) + 1 'bonus
                     MonsterHits = MonsterHits + 1 + Level(CurrentPlayer)
                     CheckActMonsters
@@ -3697,7 +3720,7 @@
             Case 1, 3, 5, 7, 9
                 GiEffect 2
                 DOF 125, DOFPulse
-                DMD "leftramp.wmv", "", "", 2000
+                DMD "leftramp.gif", "", "", 2000
                 Monsters(CurrentPlayer) = Monsters(CurrentPlayer) + 1 'bonus
                 MonsterHits = MonsterHits + 1 + Level(CurrentPlayer)
                 CheckActMonsters
@@ -3741,7 +3764,7 @@
             Case 1, 3, 5, 7, 9
                 GiEffect 2
                 DOF 125, DOFPulse
-                DMD "rightramp.wmv", "", "", 2000
+                DMD "rightramp.gif", "", "", 2000
                 Monsters(CurrentPlayer) = Monsters(CurrentPlayer) + 1 'bonus
                 MonsterHits = MonsterHits + 1 + Level(CurrentPlayer)
                 CheckActMonsters
@@ -4049,7 +4072,7 @@
 Sub StartAct1
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "act1.wmv", " ", "         ", 6500
+    DMD "act1.gif", " ", "         ", 6500
     ' start music after the intro
     vpmtimer.AddTimer 6000, "PlaySong ""mu_act"" '"
     'setup variables
@@ -4076,7 +4099,7 @@
     StopMonsterTimer
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "act-complete.wmv", "", "", 12000
+    DMD "act-complete.gif", "", "", 12000
     FlashEffect 2
     DOF 154, DOFPulse
     'setup variables
@@ -4098,7 +4121,7 @@
 
 Sub StartButcher
     StopSound Song:Song = ""
-    DMD "butcher-start.wmv", "", "", 12000
+    DMD "butcher-start.gif", "", "", 12000
     ' start music after the intro
     vpmtimer.AddTimer 12000, "PlaySong ""mu_lordfight"" '"
     vpmtimer.AddTimer 8000, "PlaySound ""battle"" '"
@@ -4143,7 +4166,7 @@
 Sub WinButcher
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "butcher-defeated.wmv", "", "", 14000
+    DMD "butcher-defeated.gif", "", "", 14000
     FlashEffect 2
     DOF 154, DOFPulse
     LightEffect 2
@@ -4177,7 +4200,7 @@
 Sub StartAct2
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "act2.wmv", " ", "         ", 6500
+    DMD "act2.gif", " ", "         ", 6500
     ' start music after the intro
     vpmtimer.AddTimer 6000, "PlaySong ""mu_act2"" '"
     'setup variables
@@ -4204,7 +4227,7 @@
     StopMonsterTimer
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "act-complete.wmv", "", "", 12000
+    DMD "act-complete.gif", "", "", 12000
     FlashEffect 2
     DOF 154, DOFPulse
     'setup variables
@@ -4229,7 +4252,7 @@
 
 Sub StartBelial
     StopSound Song:Song = ""
-    DMD "belial-start.wmv", "", "", 12000
+    DMD "belial-start.gif", "", "", 12000
     ' start music after the intro
     vpmtimer.AddTimer 12000, "PlaySong ""mu_lordfight"" '"
     vpmtimer.AddTimer 8000, "PlaySound ""battle"" '"
@@ -4264,7 +4287,7 @@
 Sub WinBelial
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "belial-defeated.wmv", "", "", 14000
+    DMD "belial-defeated.gif", "", "", 14000
     FlashEffect 2
     DOF 154, DOFPulse
     LightEffect 2
@@ -4318,7 +4341,7 @@
 Sub StartAct3
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "act3.wmv", " ", "         ", 6500
+    DMD "act3.gif", " ", "         ", 6500
     ' start music after the intro
     vpmtimer.AddTimer 6000, "PlaySong ""mu_act"" '"
     'setup variables
@@ -4345,7 +4368,7 @@
     StopMonsterTimer
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "act-complete.wmv", "", "", 12000
+    DMD "act-complete.gif", "", "", 12000
     FlashEffect 2
     DOF 154, DOFPulse
     'setup variables
@@ -4368,7 +4391,7 @@
 
 Sub StartAzmodan
     StopSound Song:Song = ""
-    DMD "azmodan-start.wmv", "", "", 20000
+    DMD "azmodan-start.gif", "", "", 20000
     ' start music after the intro
     vpmtimer.AddTimer 20000, "PlaySong ""mu_lordfight"" '"
     vpmtimer.AddTimer 8000, "PlaySound ""battle"" '"
@@ -4403,7 +4426,7 @@
 Sub WinAzmodan
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "azmodan-defeated.wmv", "", "", 14000
+    DMD "azmodan-defeated.gif", "", "", 14000
     FlashEffect 2
     DOF 154, DOFPulse
     LightEffect 2
@@ -4433,7 +4456,7 @@
 Sub StartAct4
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "act4.wmv", " ", "         ", 6500
+    DMD "act4.gif", " ", "         ", 6500
     ' start music after the intro
     vpmtimer.AddTimer 6000, "PlaySong ""mu_act2"" '"
     'setup variables
@@ -4459,7 +4482,7 @@
     StopMonsterTimer
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "act-complete.wmv", "", "", 12000
+    DMD "act-complete.gif", "", "", 12000
     FlashEffect 2
     DOF 154, DOFPulse
     'setup variables
@@ -4480,7 +4503,7 @@
 
 Sub StartDiablo
     StopSound Song:Song = ""
-    DMD "diablo-start.wmv", "", "", 19000
+    DMD "diablo-start.gif", "", "", 19000
     ' start music after the intro
     vpmtimer.AddTimer 19000, "PlaySong ""mu_lordfight"" '"
     vpmtimer.AddTimer 8000, "PlaySound ""battle"" '"
@@ -4514,7 +4537,7 @@
 Sub WinDiablo
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "diablo-defeated.wmv", "", "", 14000
+    DMD "diablo-defeated.gif", "", "", 14000
     FlashEffect 2
     DOF 154, DOFPulse
     LightEffect 2
@@ -4544,7 +4567,7 @@
 Sub StartAct5
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "act5.wmv", " ", "         ", 6500
+    DMD "act5.gif", " ", "         ", 6500
     ' start music after the intro
     vpmtimer.AddTimer 6000, "PlaySong ""mu_act"" '"
     'setup variables
@@ -4570,7 +4593,7 @@
     StopMonsterTimer
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "act-complete.wmv", "", "", 12000
+    DMD "act-complete.gif", "", "", 12000
     FlashEffect 2
     DOF 154, DOFPulse
     ' Score an extra 5 million points
@@ -4594,7 +4617,7 @@
 
 Sub StartMalthael
     StopSound Song:Song = ""
-    DMD "malthael-start.wmv", "", "", 18000
+    DMD "malthael-start.gif", "", "", 18000
     ' start music after the intro
     vpmtimer.AddTimer 18000, "PlaySong ""mu_lordfight"" '"
     vpmtimer.AddTimer 8000, "PlaySound ""battle"" '"
@@ -4652,7 +4675,7 @@
     Dim i
     'play a sound - video -dmd
     StopSound Song:Song = ""
-    DMD "malthael-defeated.wmv", "", "", 80000
+    DMD "malthael-defeated.gif", "", "", 80000
     'light show
     LightSeqFlasher.UpdateInterval = 150
     LightSeqFlasher.Play SeqRandom, 20, , 80000
